

<!DOCTYPE html>
<meta charset="utf-8">
<title>ODU Student Demographics Project - Prototype</title>
<style>
body { 
  color: #666; 
  background: #f3f3f3; 
  font: normal 10px "Helvetica Neue", Helvetica, sans-serif; 
  margin: 2em; 
}
#map {
  border:2px solid #000;
  width:960px;
  height:550px;
}
.country {
  fill: #ccc;
  stroke: #fff;
  stroke-width: .5px;
  stroke-linejoin: round;
}

.hidden { 
  display: none; 
}
div.tooltip {
  color: #222; 
  background: #fff; 
  padding: .5em; 
  text-shadow: #f5f5f5 0 1px 0;
  border-radius: 2px; 
  box-shadow: 0px 0px 2px 0px #a6a6a6; 
  opacity: 0.9; 
  position: absolute;
}

</style>
<body>
<h1>ODU Student Demographics Project - Prototype</h1>
<br><br>
<div id="map"></div>

<script src="js/d3.v3.min.js"></script>
<script src="js/queue.v1.js"></script>
<script src="js/topojson.js"></script>
<script>
// The SVG container
var width  = 960,
    height = 550;

var color = d3.scale.category10();

var projection = d3.geo.mercator()
                .translate([480, 300])
                .scale(970);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);

var tooltip = d3.select("#map").append("div")
    .attr("class", "tooltip");

queue()
    .defer(d3.json, "http://www.cs.odu.edu/~tfouda/Final-Project/World/world-110m.json")
    .defer(d3.tsv, "http://www.cs.odu.edu/~tfouda/Final-Project/World/world-country-names.tsv")
    .await(ready);

function ready(error, world, names) {

  var countries = topojson.object(world, world.objects.countries).geometries,
      neighbors = topojson.neighbors(world, countries),
      i = -1,
      n = countries.length;

  countries.forEach(function(d) { 
    d.name = names.filter(function(n) { return d.id == n.id; })[0].name; 
  });

var country = svg.selectAll(".country").data(countries);

  country
   .enter()
    .insert("path")
    .attr("class", "country")    
      .attr("title", function(d,i) { return d.name; })
      .attr("d", path)
      .style("fill", function(d, i) { return color(d.color = d3.max(neighbors[i], function(n) { return countries[n].color; }) + 1 | 0); });

    //Show/hide tooltip
    country
      .on("mousemove", function(d,i) {
        var mouse = d3.mouse(svg.node()).map( function(d) { return parseInt(d); } );

        tooltip
          .classed("hidden", false)
          .attr("style", "left:"+(mouse[0]+25)+"px;top:"+mouse[1]+"px")
          .html(d.name)
      })
      .on("mouseout",  function(d,i) {
        tooltip.classed("hidden", true)
      })
	  .on("click", function(d,i) {
		d3.select("#ID1").remove();
		
		var svg1 = d3.select("#map").append("svg")
					 .attr("id", "ID1")
					 .attr("width", width)
					 .attr("height", height);
		
		var circleData = [{ "cx": 20, "cy": 20, "radius": 20, "color" : "green" }, { "cx": 70, "cy": 70, "radius": 20, "color" : "purple" }];
		
		var circles = svg1.selectAll("circle")
						  .data(circleData)
						  .enter()
						  .append("circle")
						  .attr("cx", function(d) {return d.cx; })
						  .attr("cy", function(d) {return d.cy; })
						  .attr("r", function(d) {return d.radius; })
						  .attr("fill", function(d) {return d.color; });
						  
		svg1.selectAll("text")
			.data(circleData)
			.enter()
			.append("text")
			.text(d.name)
			.attr("x", function(d) {return d.cx; })
			.attr("y", function(d) {return d.cy; });
						  
		
		
	}
	  
	  )
	  ;

}
</script>